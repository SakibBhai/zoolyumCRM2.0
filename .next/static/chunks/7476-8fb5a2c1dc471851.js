"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7476],{7476:(e,s,r)=>{r.d(s,{MainLayout:()=>U});var t=r(9159),a=r(337),n=r(1375),l=r(1505),i=r.n(l),o=r(3346),c=r(9043),d=r(3332),m=r(2217),u=r(8090),x=r(2832),h=r(2137),g=r(475),f=r(7691),p=r(4584),v=r(6298),b=r(6955),N=r(9193),y=r(2754),A=r(203),j=r(5958);let w=[{title:"Dashboard",href:"/dashboard",icon:m.A},{title:"Leads",href:"/leads",icon:u.A},{title:"Clients",href:"/clients",icon:x.A},{title:"Projects",href:"/projects",icon:h.A},{title:"Tasks",href:"/tasks",icon:g.A},{title:"Team",href:"/team",icon:f.A,roles:["ADMIN","MANAGER"]},{title:"Proposals",href:"/proposals",icon:p.A},{title:"Finance",href:"/finance",icon:v.A,roles:["ADMIN","MANAGER"]},{title:"Reports",href:"/reports",icon:b.A,roles:["ADMIN","MANAGER"]}];function E(){var e;let[s,r]=(0,n.useState)(!1),l=(0,o.usePathname)(),{user:m,hasRole:u,signOut:x}=(0,a.A)(),h=w.filter(e=>!e.roles||e.roles.some(e=>u(e)));return(0,t.jsxs)(t.Fragment,{children:[!s&&(0,t.jsx)("div",{className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:()=>r(!0)}),(0,t.jsxs)("div",{className:(0,c.cn)("fixed left-0 top-0 z-50 h-full bg-white border-r border-gray-100 transition-all duration-300 shadow-sm",s?"-translate-x-full lg:w-16 lg:translate-x-0":"w-64 translate-x-0 lg:w-64"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[!s&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-sm",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg",children:"AC"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-bold text-gray-900 text-lg",children:"AgencyCRM"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Professional Edition"})]})]}),(0,t.jsx)(d.$,{variant:"ghost",size:"icon",onClick:()=>r(!s),className:"lg:hidden hover:bg-gray-100",children:s?(0,t.jsx)(N.A,{className:"h-5 w-5"}):(0,t.jsx)(y.A,{className:"h-5 w-5"})})]}),(0,t.jsx)("nav",{className:"flex-1 p-6 space-y-2",children:h.map(e=>{let a=l===e.href||l.startsWith(e.href+"/"),n=e.icon;return(0,t.jsxs)(i(),{href:e.href,className:(0,c.cn)("flex items-center space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 group",a?"bg-blue-50 text-blue-700 shadow-sm border border-blue-100":"text-gray-600 hover:bg-gray-50 hover:text-gray-900",s&&"justify-center px-3"),onClick:()=>r(!0),children:[(0,t.jsx)(n,{className:(0,c.cn)("h-5 w-5 transition-colors duration-200",a?"text-blue-700":"text-gray-500 group-hover:text-gray-700")}),!s&&(0,t.jsx)("span",{className:"font-medium",children:e.title}),!s&&a&&(0,t.jsx)("div",{className:"ml-auto w-2 h-2 bg-blue-600 rounded-full"})]},e.href)})}),(0,t.jsxs)("div",{className:"p-6 border-t border-gray-100 space-y-3",children:[(0,t.jsxs)(i(),{href:"/settings",className:(0,c.cn)("flex items-center space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 group","/settings"===l?"bg-blue-50 text-blue-700 shadow-sm border border-blue-100":"text-gray-600 hover:bg-gray-50 hover:text-gray-900",s&&"justify-center px-3"),children:[(0,t.jsx)(A.A,{className:(0,c.cn)("h-5 w-5 transition-colors duration-200","/settings"===l?"text-blue-700":"text-gray-500 group-hover:text-gray-700")}),!s&&(0,t.jsx)("span",{className:"font-medium",children:"Settings"})]}),(0,t.jsxs)(d.$,{variant:"ghost",onClick:x,className:(0,c.cn)("w-full justify-start space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 text-gray-600 hover:bg-red-50 hover:text-red-700 group",s&&"justify-center px-3"),children:[(0,t.jsx)(j.A,{className:"h-5 w-5 transition-colors duration-200 text-gray-500 group-hover:text-red-600"}),!s&&(0,t.jsx)("span",{className:"font-medium",children:"Sign Out"})]}),!s&&m&&(0,t.jsx)("div",{className:"mt-4 p-4 bg-gray-50 rounded-xl border border-gray-100",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-gray-600 to-gray-700 rounded-full flex items-center justify-center shadow-sm",children:(0,t.jsx)("span",{className:"text-white font-semibold text-sm",children:(null===(e=m.name)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-gray-900 truncate",children:m.name||"Demo User"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate",children:m.email||"demo@agency.com"})]})]})})]})]}),(0,t.jsx)(d.$,{variant:"ghost",size:"icon",className:"fixed top-4 left-4 z-40 lg:hidden",onClick:()=>r(!1),children:(0,t.jsx)(N.A,{className:"h-6 w-6"})})]})}var R=r(2912);function U(e){let{children:s}=e,{user:r,isLoading:n}=(0,a.A)();return n?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(R.A,{className:"h-8 w-8 animate-spin"})}):r?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(E,{}),(0,t.jsx)("main",{className:"lg:ml-64 min-h-screen",children:(0,t.jsx)("div",{className:"p-4 lg:p-5 w-full",children:s})})]}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Please sign in to access this page."}),(0,t.jsx)("a",{href:"/auth/signin",className:"text-blue-600 hover:text-blue-800 underline",children:"Sign In"})]})})}},3332:(e,s,r)=>{r.d(s,{$:()=>c});var t=r(9159),a=r(1375),n=r(9033),l=r(241),i=r(9043);let o=(0,l.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,s)=>{let{className:r,variant:a,size:l,asChild:c=!1,...d}=e,m=c?n.DX:"button";return(0,t.jsx)(m,{className:(0,i.cn)(o({variant:a,size:l,className:r})),ref:s,...d})});c.displayName="Button"},337:(e,s,r)=>{r.d(s,{A:()=>h});var t,a=r(6165),n=r(6232),l=r(1685),i=r(3622),o=r(55);let c=null!==(t=globalThis.prisma)&&void 0!==t?t:new n.PrismaClient({log:["query"]});var d=r(6305),m=r(2422);let u="true"===m.env.AUTH_BYPASS_ENABLED;function x(e,s){let r={[n.UserRole.VIEWER]:0,[n.UserRole.AGENT]:1,[n.UserRole.MANAGER]:2,[n.UserRole.ADMIN]:3};return r[e]>=r[s]}function h(){let{data:e,status:s}=(0,a.useSession)(),r=!!(null==e?void 0:e.user),t=null==e?void 0:e.user,l=e=>null!=t&&!!t.role&&x(t.role,e);return{user:t,isLoading:"loading"===s,isAuthenticated:r,hasRole:l,canAccess:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.UserRole.AGENT;return null!=t&&!!t.id&&null!=t&&!!t.role&&function(e,s,r){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.UserRole.AGENT;return!!x(e,n.UserRole.MANAGER)||!!r&&s===r||x(e,t)}(t.role,t.id,e,s)},isAdmin:()=>l(n.UserRole.ADMIN),isManager:()=>l(n.UserRole.MANAGER),isAgent:()=>l(n.UserRole.AGENT),isViewer:()=>l(n.UserRole.VIEWER)}}(0,l.y)(c),(0,o.A)({clientId:m.env.GOOGLE_CLIENT_ID,clientSecret:m.env.GOOGLE_CLIENT_SECRET}),(0,i.A)({name:"credentials",credentials:{email:{label:"Email",type:"email",placeholder:"john@example.com"},password:{label:"Password",type:"password"}},async authorize(e){if(!(null==e?void 0:e.email)||!(null==e?void 0:e.password))return null;if(u){console.warn("\uD83D\uDEA8 AUTH BYPASS MODE ENABLED - DEVELOPMENT ONLY!");let e=await c.user.findFirst({where:{role:n.UserRole.ADMIN,isActive:!0},select:{id:!0,email:!0,name:!0,role:!0,avatar:!0}});return e?{id:e.id,email:e.email,name:e.name,role:e.role,avatar:e.avatar}:{id:"bypass-user",email:"bypass@agency.com",name:"Bypass User (DEV)",role:n.UserRole.ADMIN,avatar:null}}let s=await c.user.findUnique({where:{email:e.email},select:{id:!0,email:!0,name:!0,password:!0,role:!0,avatar:!0,isActive:!0}});return s&&s.isActive&&s.password&&await (0,d.compare)(e.password,s.password)?{id:s.id,email:s.email,name:s.name,role:s.role,avatar:s.avatar}:null}})},9043:(e,s,r)=>{r.d(s,{cn:()=>n});var t=r(7497),a=r(2636);function n(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,a.QP)((0,t.$)(s))}}}]);